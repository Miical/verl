{
  "output_dir": "outputs/piper_offline_local_learner1105_yag",
  "job_name": "piper_local_run1",
  "resume": false,
  "seed": 1000,
  "num_workers": 4,
  "batch_size": 256,
  "steps": 100000,
  "log_freq": 500,
  "save_checkpoint": true,
  "save_freq": 50000,

  "wandb": {
    "enable": false,
    "project": "local_disabled",
    "disable_artifact": true
  },

  "dataset": {
    "repo_id": "local/test_hil_serl_v0.5_cropped_v2",
    "root": "/home/agilex-home/agilex/dengqiuping/code/lerobot/datasets/test_hil_serl_v0.5_cropped_v2",
    "use_imagenet_stats": true
  },

  "policy": {
    "type": "sac",
    "push_to_hub": false,
      "normalization_mapping": {
      "VISUAL": "MEAN_STD",
      "STATE": "MIN_MAX",
      "ENV": "MIN_MAX",
      "ACTION": "MIN_MAX"
    },

    "input_features": {
      "observation.image.front": { "type": "VISUAL", "shape": [3, 128, 128] },
      "observation.image.left":  { "type": "VISUAL", "shape": [3, 128, 128] },
      "observation.image.right": { "type": "VISUAL", "shape": [3, 128, 128] }
    },
    "output_features": {
      "action": { "type": "ACTION", "shape": [3] }
    },

    "device": "cuda",
    "storage_device": "cuda",

    "dataset_stats": {
      "observation.images": {
        "mean": [0.485, 0.456, 0.406],
        "std":  [0.229, 0.224, 0.225]
      },
      "action": {
        "min": [-0.03, -0.03, -0.03],
        "max": [ 0.03,  0.03,  0.03]
      }
    },

    "num_discrete_actions": 3,

    "vision_encoder_name": null,
    "freeze_vision_encoder": false,
    "image_encoder_hidden_dim": 32,
    "shared_encoder": true,
    "image_embedding_pooling_dim": 8,

    "online_steps": 1000000,
    "online_buffer_capacity": 30000,
    "offline_buffer_capacity": 20000,
    "online_step_before_learning": 100,
    "policy_update_freq": 1,

    "discount": 0.97,
    "temperature_init": 0.01,
    "num_critics": 2,
    "num_subsample_critics": null,
    "critic_lr": 0.0003,
    "actor_lr": 0.0003,
    "temperature_lr": 0.0003,
    "critic_target_update_weight": 0.005,
    "utd_ratio": 2,
    "state_encoder_hidden_dim": 256,
    "latent_dim": 256,
    "target_entropy": null,
    "use_backup_entropy": true,
    "grad_clip_norm": 40.0,

    "critic_network_kwargs": {
      "hidden_dims": [256, 256],
      "activate_final": true,
      "final_activation": null
    },
    "actor_network_kwargs": {
      "hidden_dims": [256, 256],
      "activate_final": true
    },
    "policy_kwargs": {
      "use_tanh_squash": true,
      "std_min": 1e-5,
      "std_max": 10.0,
      "init_final": 0.05
    },

    "actor_learner_config": {
      "learner_host": "127.0.0.1",
      "learner_port": 50051,
      "policy_parameters_push_frequency": 4,
      "queue_get_timeout": 0.5
    },
    "concurrency": {
      "actor": "threads",
      "learner": "threads"
    },

    "async_prefetch": false,
    "use_torch_compile": false
  },

  "env": {
    "type": "gym_manipulator",
    "name": "real_robot",
    "fps": 30,

    "robot": {
      "type": "piper_single_follower",
      "urdf_path": "local_assets/piper.urdf",
      "target_frame_name": "link6",
      "cameras": {
        "front": {
          "type": "orbbec_dabai",
          "serial_number_or_name": "CC1B25100EM",
          "width": 640,
          "height": 480,
          "fps": 30
        },
        "left": {
          "type": "intelrealsense",
          "serial_number_or_name": "242522071187",
          "width": 640,
          "height": 480,
          "fps": 30
        },
        "right": {
          "type": "intelrealsense",
          "serial_number_or_name": "327122075682",
          "width": 640,
          "height": 480,
          "fps": 30
        }
      }
    },

    "teleop": {
      "type": "keyboard_ee",
      "use_gripper": true
    },

    "processor": {
      "observation": {
        "display_cameras": false,
        "add_joint_velocity_to_observation": false,
        "add_current_to_observation": false
      },
      "image_preprocessing": {
        "crop_params_dict": {
          "observation.images.front": [0, 0, 480, 640],
          "observation.images.left":  [0, 0, 480, 640],
          "observation.images.right": [0, 0, 480, 640]
        },
        "resize_size": [128, 128]
      },
      "reset": {
        "fixed_reset_joint_positions": [0.0, 0, 0, 0, 0.0, 0.0, 0],
        "control_time_s": 20.0,
        "reset_time_s": 2.5,
        "terminate_on_success": true
      },
      "gripper": {
        "use_gripper": true,
        "gripper_penalty": -0.02
      },
      "inverse_kinematics": {
        "urdf_path": "local_assets/piper.urdf",
        "target_frame_name": "link6",
        "end_effector_bounds": {
          "min": [-0.40, -0.30, 0.00],
          "max": [ 0.40,  0.30, 0.45]
        },
        "end_effector_step_sizes": { "x": 0.0001, "y": 0.0001, "z": 0.0001 }
      },
      "max_gripper_pos": 2.0,
      "reward_classifier": {
        "pretrained_path": "/home/agilex-home/agilex/dengqiuping/code/lerobot/models/reward_classifier/test_hil_serl_v0.5_cropped_v2/pretrained_model",
        "success_threshold": 0.7,
        "success_reward": 1.0
      }
    },

    "features": {
      "observation.images.front": { "type": "VISUAL", "shape": [3, 128, 128] },
      "observation.images.left":  { "type": "VISUAL", "shape": [3, 128, 128] },
      "observation.images.right": { "type": "VISUAL", "shape": [3, 128, 128] },
      "action": { "type": "ACTION", "shape": [3] }
    },
    "features_map": {
      "observation.images.front": "observation.images.front",
      "observation.images.left":  "observation.images.left",
      "observation.images.right": "observation.images.right",
      "action": "action"
    },

    "task": "hilserl_piper"
  }
}
